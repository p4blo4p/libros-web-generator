<?xml version="1.0" encoding="UTF-8"?>
<urlset xmlns="https://www.sitemaps.org/schemas/sitemap/0.9"
        xmlns:image="https://www.google.com/schemas/sitemap-image/1.1">

    {% for book in books %}
      {% if book.isbn13%}
      <url>
        <loc>{{ url_for('book_by_identifier', author=book.author, book=book.title, identifier=book.isbn13, _external=True) }}</loc>
        {% include "partials/sitemap_data.xml" %}

      </url>
      {% endif %}

      {# Considera si realmente necesitas entradas duplicadas si un libro tiene tanto ISBN13 como ISBN10
         y ambos apuntan al mismo contenido. Generalmente, una URL canónica por contenido es suficiente.
         Si son páginas diferentes, entonces está bien.
      #}
      {% if book.isbn10 %} 
      <url>
        <loc>{{ url_for('book_by_identifier', author=book.author, book=book.title, identifier=book.isbn10, _external=True) }}</loc>
        {% include "partials/sitemap_data.xml" %}
        {# ... (etiquetas personalizadas opcionales como arriba) ... #}
      </url>
      {% endif %}
  
      {% if book.asin %} 
      <url>
        <loc>{{ url_for('book_by_identifier', author=book.author, book=book.title, identifier=book.asin, _external=True) }}</loc>
        {% include "partials/sitemap_data.xml" %}
        {# ... (etiquetas personalizadas opcionales como arriba) ... #}
      </url>
      {% endif %}
    {% endfor %}
</urlset>